# 実装計画

## 1. プロジェクト基盤のセットアップ

- [x] 1.1 React 19プロジェクトの初期化とTypeScript設定
  - Viteを使用してReact 19プロジェクトを作成
  - TypeScript設定ファイルを構成（strict mode有効化）
  - 必要な型定義パッケージをインストール
  - 開発サーバーが正常に起動することを確認
  - _Requirements: 全要件の基盤となる環境構築_

- [ ] 1.2 プロジェクト構造とルーティングの確立
  - src配下のディレクトリ構造を作成（components, services, repositories, types）
  - エントリーポイント（main.tsx, App.tsx）を設定
  - 基本的なスタイル設定（CSS）を準備
  - HTMLテンプレートファイルを設定
  - _Requirements: 全要件の基盤となるプロジェクト構造_

## 2. データモデルと型定義の実装

- [ ] 2.1 TODOアイテムのデータモデル定義
  - TodoItem型を定義（id, title, completed, createdAt, completedAt）
  - Result型を定義（成功/失敗パターン）
  - エラー型を定義（CreateTodoError, ToggleTodoError, DeleteTodoError, StorageError）
  - 型の妥当性を確認するユニットテストを作成
  - _Requirements: 1.3, 1.4, 3.4_

## 3. データ永続化層の実装

- [ ] 3.1 TodoRepositoryの基本実装
  - LocalStorageへのデータ保存機能を実装
  - LocalStorageからのデータ読み込み機能を実装
  - ストレージ可用性チェック機能を実装
  - JSON形式でのシリアライズ/デシリアライズを実装
  - _Requirements: 5.1, 5.2_

- [ ] 3.2 TodoRepositoryのエラーハンドリング
  - ストレージ容量超過のエラーハンドリングを実装
  - パースエラーのハンドリングを実装
  - ストレージ利用不可時の対応を実装
  - 各エラーケースのユニットテストを作成
  - _Requirements: 5.3, 5.4_

## 4. ビジネスロジック層の実装

- [ ] 4.1 TodoServiceの基本CRUD操作
  - TODOアイテム作成機能を実装（UUID生成、初期状態設定、タイムスタンプ記録）
  - TODOアイテム取得機能を実装（全件取得、ID指定取得）
  - TODOアイテム削除機能を実装
  - Repositoryとの連携を確立
  - _Requirements: 1.1, 1.3, 1.4, 4.1, 4.3, 4.4_

- [ ] 4.2 TodoServiceの完了状態管理
  - 完了/未完了の切り替え機能を実装
  - 完了日時の記録機能を実装
  - 未完了に戻す際のcompletedAtクリア処理を実装
  - 状態変更のユニットテストを作成
  - _Requirements: 3.1, 3.3, 3.4_

- [ ] 4.3 TodoServiceのバリデーションとエラーハンドリング
  - 空タイトルのバリデーションを実装
  - 存在しないIDに対するエラーハンドリングを実装
  - ストレージ失敗時のエラー伝播を実装
  - エラーケースのユニットテストを作成
  - _Requirements: 1.2_

## 5. Reactコンポーネント層の実装

- [ ] 5.1 Appコンポーネント（Container）の実装
  - useStateでTODOリストの状態管理を実装
  - useEffectで初期データ読み込みを実装
  - useEffectでデータ変更時の自動保存を実装
  - エラー状態の管理を実装
  - _Requirements: 2.1, 5.1, 5.2_

- [ ] 5.2 TodoFormコンポーネント（Presentational）の実装
  - 入力フォームのUI実装
  - 入力バリデーション（空チェック）を実装
  - エラーメッセージ表示を実装
  - 作成成功時の入力フィールドクリアを実装
  - _Requirements: 1.1, 1.2_

- [ ] 5.3 TodoListとTodoItemコンポーネント（Presentational）の実装
  - TodoListコンポーネントでリスト表示を実装
  - 空リスト時のメッセージ表示を実装
  - TodoItemコンポーネントで個別アイテム表示を実装
  - 完了状態による視覚的区別（打ち消し線）を実装
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 3.2_

- [ ] 5.4 TodoItemコンポーネントのアクション実装
  - 完了/未完了切り替えボタンを実装
  - 削除ボタンを実装
  - ボタンクリック時の親コンポーネントへのコールバック連携を実装
  - UI更新が即座に反映されることを確認
  - _Requirements: 3.1, 3.3, 4.1, 4.2_

## 6. エラーハンドリングとユーザーフィードバックの実装

- [ ] 6.1 エラーメッセージコンポーネントの実装
  - エラーメッセージ表示用のコンポーネントを作成
  - ストレージエラー時の警告バナーを実装
  - エラータイプに応じた適切なメッセージを表示
  - エラー発生時のユーザーガイダンスを提供
  - _Requirements: 5.3, 5.4_

- [ ] 6.2 グローバルエラーハンドリングの統合
  - Appコンポーネントでのエラー状態管理を強化
  - try-catchブロックで予期しないエラーをキャッチ
  - エラーログをconsole.errorで出力
  - エラー発生後のリカバリー処理を実装
  - _Requirements: 5.3_

## 7. スタイリングとUI/UX改善

- [ ] 7.1 基本的なスタイリングの実装
  - TODOアプリ全体のレイアウトを実装
  - 入力フォームのスタイリングを実装
  - TODOリストのスタイリングを実装
  - ボタンのスタイリングを実装
  - _Requirements: 全要件のUI品質向上_

- [ ] 7.2 完了状態の視覚的表現の強化
  - 完了アイテムの打ち消し線スタイルを実装
  - 未完了と完了済みの色分けを実装
  - ホバー効果を追加
  - アクセシビリティ（aria属性）を考慮
  - _Requirements: 2.3, 3.2_

## 8. 統合とエンドツーエンド機能確認

- [ ] 8.1 全コンポーネントの統合確認
  - Appコンポーネントで全子コンポーネントを統合
  - データフローが正しく動作することを確認
  - 状態管理とUI更新の同期を確認
  - ブラウザでの手動動作確認を実施
  - _Requirements: 全要件の統合_

- [ ] 8.2 LocalStorageとの永続化連携確認
  - データ作成→保存→リロード→復元のフロー確認
  - 複数アイテムの作成と永続化を確認
  - 完了状態の永続化を確認
  - 削除の永続化を確認
  - _Requirements: 5.1, 5.2_

## 9. テストの実装

- [ ] 9.1 TodoRepositoryのユニットテスト
  - saveTodos, loadTodos, clearTodosのテストを作成
  - エラーケース（STORAGE_UNAVAILABLE, QUOTA_EXCEEDED, PARSE_ERROR）のテストを作成
  - モックLocalStorageを使用したテストを実装
  - カバレッジ80%以上を目標
  - _Requirements: 5.1, 5.2, 5.3, 5.4_

- [ ] 9.2 TodoServiceのユニットテスト
  - createTodo, toggleTodo, deleteTodoのテストを作成
  - バリデーションエラーのテストを作成
  - Repository連携のテストを作成
  - エッジケース（存在しないID等）のテストを作成
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 3.1, 3.3, 3.4, 4.1, 4.3, 4.4_

- [ ] 9.3 Reactコンポーネントのテスト
  - React Testing Libraryを使用したコンポーネントテストを作成
  - TodoFormの入力バリデーションテストを作成
  - TodoItemの完了切り替えテストを作成
  - TodoListの空リスト表示テストを作成
  - _Requirements: 1.1, 1.2, 2.1, 2.2, 2.3, 2.4, 3.1, 3.2, 3.3, 4.1, 4.2_

- [ ] 9.4 統合テストとE2Eシナリオ
  - アイテム作成→表示→完了→削除のフルフローテストを作成
  - LocalStorage永続化の統合テストを作成
  - エラーハンドリングの統合テストを作成
  - ユーザーシナリオベースのテストを作成
  - _Requirements: 全要件の統合テスト_

## 10. パフォーマンス最適化と最終確認

- [ ] 10.1 パフォーマンス最適化
  - 不要な再レンダリングの削減（React.memo, useMemo, useCallback検討）
  - 大量アイテム（100件以上）での動作確認
  - LocalStorage読み書き速度の測定と最適化
  - メモリリーク確認
  - _Requirements: 全要件のパフォーマンス要件_

- [ ] 10.2 最終動作確認とリリース準備
  - 全要件が満たされていることを確認
  - クロスブラウザ動作確認（Chrome, Firefox, Safari）
  - エッジケースの手動テストを実施
  - 本番ビルドの作成と動作確認
  - _Requirements: 全要件の最終確認_
